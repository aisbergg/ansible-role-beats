---
__auditbeat_config_defaults:
  auditbeat.config.modules:
    path: ${path.config}/modules.d/*.yml
    reload.period: 10s
    reload.enabled: false

  auditbeat.max_start_delay: 10s

  auditbeat.modules:
    - module: auditd
      resolve_ids: true
      failure_mode: silent
      backlog_limit: 8196
      rate_limit: 0
      include_raw_message: false
      include_warnings: false
      audit_rule_files: [ '${path.config}/audit.rules.d/*.conf' ]
      audit_rules: |
        # Identity changes.
        -w /etc/group -p wa -k identity
        -w /etc/passwd -p wa -k identity
        -w /etc/gshadow -p wa -k identity

        # Unauthorized access attempts.
        -a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EACCES -k access
        -a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EPERM -k access

    - module: file_integrity
      paths:
        - /bin
        - /usr/bin
        - /sbin
        - /usr/sbin
        - /etc
      exclude_files:
        - '(?i)\.sw[nop]$'
        - '~$'
        - '/\.git($|/)'
      scan_at_start: true
      scan_rate_per_sec: 50 MiB
      max_file_size: 100 MiB
      hash_types: [blake2b_256]
      recursive: false

  logging.to_files: false
